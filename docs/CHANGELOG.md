# SmartNotes.ai 更新日志

## 版本历史

### v2.8.0 - Markdown渲染支持 (2025-09-17)

#### 📝 核心功能

- **Markdown解析**: 添加markdown到HTML的自动转换功能
- **智能检测**: 自动检测内容是否包含markdown语法
- **全面集成**: 智能处理和大纲生成都支持markdown渲染
- **格式支持**: 支持粗体、斜体、标题、列表、代码等常见markdown语法

#### 🎯 用户体验

- **自动渲染**: 智能处理生成的markdown内容自动转换为格式化文本
- **视觉改进**: 粗体、斜体、列表等格式正确显示，不再显示原始符号
- **无缝体验**: 用户无需手动处理markdown格式，系统自动处理
- **向后兼容**: 普通文本内容不受影响，只有markdown内容才会被解析

#### 🔧 技术实现

- 安装`marked`库用于markdown解析
- 创建`markdownParser.ts`工具函数
- 实现`containsMarkdown()`智能检测函数
- 修改`SmartTextProcessor`和`OutlineGenerator`插入逻辑
- 支持GitHub风格的markdown语法和换行符转换

#### 📋 支持的语法

- **文本格式**: 粗体(`**text**`)、斜体(`*text*`)、行内代码(`` `code` ``)
- **标题**: 一级到六级标题(`#` 到 `######`)
- **列表**: 有序列表(`1.`)、无序列表(`-`、`*`、`+`)
- **其他**: 换行符、代码块、链接、图片等

### v2.7.0 - 撤销/重做功能支持 (2025-09-17)

#### ⌨️ 核心功能

- **撤销/重做支持**: 添加完整的撤销和重做功能，提升编辑体验
- **键盘快捷键**: 支持Cmd/Ctrl+Z撤销，Cmd/Ctrl+Y和Cmd/Ctrl+Shift+Z重做
- **工具栏按钮**: 在工具栏添加undo/redo按钮，支持鼠标点击操作
- **智能状态管理**: 按钮根据历史状态自动启用/禁用

#### 🎯 用户体验

- **主流快捷键**: 与VS Code、Word、Google Docs等主流编辑器快捷键一致
- **多平台支持**: 同时支持Mac和Windows/Linux的快捷键习惯
- **视觉反馈**: 禁用状态显示灰色，提供清晰的状态提示
- **操作便捷**: 支持连续撤销/重做操作

#### 🔧 技术实现

- 利用Tiptap内置History扩展，自动记录所有编辑操作
- 实现智能状态检查，使用`editor?.can().undo()`和`editor?.can().redo()`
- 增强ToolbarBtn组件，支持disabled状态
- 更新快捷提示，告知用户undo/redo快捷键

#### 📝 支持的操作

- 文本输入和删除
- 格式变更（粗体、斜体等）
- 列表操作
- 代码块操作
- 所有通过Tiptap进行的编辑操作

### v2.6.0 - 编辑器UI优化 (2025-09-17)

#### 🎨 UI/UX 改进

- **工具栏重新设计**: 分离文本格式工具和AI功能，提升界面层次感
- **双行布局**: 第一行显示格式工具，第二行显示AI功能，避免混乱
- **视觉分组**: 添加分隔线和背景色块，清晰区分不同功能区域
- **图标优化**: 为所有按钮添加SVG图标，提升视觉识别度
- **渐变按钮**: AI功能按钮使用渐变色彩，增强视觉吸引力
- **状态指示**: 添加AI助手在线状态指示器（绿色脉冲点）

#### 🔧 技术改进

- 优化ToolbarBtn组件样式，支持激活状态和悬停效果
- 改进响应式设计，在不同屏幕尺寸下都有良好表现
- 统一按钮尺寸和间距，提升整体一致性
- 调整编辑区域高度以适应新的工具栏设计

#### 📱 用户体验提升

- 界面更加整洁有序，功能分类清晰
- 按钮交互反馈更加明显
- 快捷提示更加友好和实用
- 整体视觉效果更加现代化

---

### v2.5.0 - 智能处理增强功能 (2025-09-17)

#### 🆕 新增功能

- **搜索相关资料**: 在智能处理前可以搜索相关资料来丰富内容
- **文档上下文考虑**: 智能处理时考虑选中文本的上下文，确保结果与整体文档风格一致
- **智能搜索集成**: 搜索功能与智能处理无缝集成，提供更准确的处理结果
- **上下文预览**: 用户可以预览文档上下文，确认是否使用

#### 🔧 技术改进

- 更新API路由支持context和searchResults参数
- 改进提示词构建，结合上下文和搜索资料
- 优化智能处理界面，提供更多选择选项
- 增强用户控制能力，支持选择性使用功能

#### 📱 用户体验提升

- 智能处理结果更加准确和符合文档风格
- 支持基于相关资料的深度内容扩展
- 提供更灵活的智能处理选项
- 改善内容质量和一致性

---

### v2.4.1 - 迭代历史功能优化 (2025-09-17)

#### 🆕 新增功能

- **展开查看全文**: 支持在迭代历史中展开查看完整内容
- **用户提示展示**: 在聊天记录中展示用户输入的优化提示
- **独立展开控制**: 每个版本的历史记录可以独立展开/收起

#### 🔧 技术改进

- 添加expandedMessages状态管理展开状态
- 优化ChatMessage接口，添加userPrompt字段
- 改进聊天记录界面布局和交互体验
- 提供更详细的内容预览和操作按钮

#### 📱 用户体验提升

- 用户可以查看完整的大纲和处理结果
- 方便review自己的优化建议历史
- 支持独立控制每个版本的展开状态
- 提供更直观的内容对比和选择体验

---

### v2.4.0 - 聊天记录式迭代优化 (2025-09-17)

#### 🆕 新增功能

- **聊天记录式迭代界面**: 将迭代优化改为聊天记录形式展示
- **版本历史管理**: 支持查看完整的迭代历史记录
- **版本选择和对比**: 支持选择任意版本进行插入和预览
- **智能版本预览**: 在聊天记录中显示版本预览和操作按钮

#### 🔧 技术改进

- 重构大纲生成组件的迭代界面
- 重构智能文本处理组件的迭代界面
- 添加ChatMessage接口支持聊天记录
- 优化用户交互体验，提供更直观的版本管理

#### 📱 用户体验提升

- 用户可以查看完整的迭代对话历史
- 支持从历史版本中获得灵感和参考
- 提供版本预览功能，方便快速对比
- 改进的界面布局，更符合用户习惯

---

### v2.3.0 - 迭代功能增强 (2025-09-17)

#### 🆕 新增功能

- **大纲生成迭代优化**: 支持基于用户反馈改进大纲结构
- **智能文本处理迭代**: 支持基于用户反馈优化处理结果
- **资料检索摘要改进**: 提供更结构化的引用格式显示

#### 🔧 技术改进

- 为所有AI功能添加迭代优化能力
- 改进用户界面，添加迭代提示输入
- 优化API路由支持迭代参数传递
- 完善模拟数据支持迭代场景测试

#### 📚 文档更新

- 更新VERCEL_DEPLOYMENT.md，强调自动部署优势
- 更新README_UPGRADE.md，添加自动部署说明
- 说明GitHub集成和推送即部署的工作流程

#### 🚀 部署优化

- 配置GitHub自动部署集成
- 优化Vercel部署配置
- 完善环境变量设置说明

---

### v2.2.0 - 智能文本处理重构 (2025-09-17)

#### 🔄 功能重构

- **重命名功能**: "文本优化" → "智能文本处理"
- **扩展处理模式**: 支持5种处理方式
  - 优化润色：改进表达方式，提升可读性
  - 内容扩展：增加细节、例子和深度分析
  - 摘要简化：提取核心要点，生成简洁摘要
  - 重写改写：用不同方式重新组织内容
  - 续写补写：基于原文进行自然续写

#### 🧠 智能特性

- **智能参数推测**: 根据提示语自动选择处理方式
- **语言风格推测**: 自动推测语言风格（正式、友好、简洁等）
- **提示语支持**: 支持自然语言描述处理需求

#### 🔧 技术改进

- 重命名组件：`TextOptimizer` → `SmartTextProcessor`
- 重命名API路由：`/api/optimize` → `/api/text-process`
- 实现智能参数推测算法
- 优化UI界面，提供更直观的操作选择

---

### v2.1.0 - 大纲生成优化 (2025-09-17)

#### 🐛 问题修复

- **格式混乱问题**: 重新设计HTML生成逻辑，生成干净的结构化内容
- **移除无关内容**: 插入的内容不再包含"文章大纲"、"开头段落"等标题
- **开头段落整合**: 将开头段落自然地整合到大纲结构中

#### ✨ 功能增强

- **自动提取标题**: 支持从现有文档中自动提取H1标题
- **自动推测参数**: 根据标题和内容提示自动推测文章类型和长度
- **多级标题结构**: 生成包含主标题和子标题的层次化结构
- **内容提示输入**: 添加可选的内容提示输入框

#### 🔧 技术改进

- 优化了`generateCompleteOutlineHtml`函数
- 改进了API提示词，要求生成更丰富的描述文本
- 更新了模拟数据，包含详细的章节描述
- 改进了HTML生成逻辑，确保描述文本正确显示

---

### v2.0.0 - 初始版本 (2025-09-17)

#### 🎉 核心功能发布

- **智能大纲生成**: 根据标题一键生成文章大纲和开头段落
- **智能文本处理**: 支持多种文本处理方式（优化、扩展、摘要、重写、续写）
- **相关资料检索**: 选中文本后检索相关资料
- **智能文本插入**: 格式感知的文本插入

#### 🏗️ 技术架构

- **前端**: Next.js 14 + TypeScript + Tiptap
- **后端**: Next.js API Routes + Edge Runtime
- **AI服务**: OpenAI GPT-4o-mini
- **部署**: Vercel (无状态函数)
- **缓存**: 客户端localStorage + 内存缓存

#### 📁 新增文件

- `app/api/outline/route.ts` - 大纲生成API
- `app/api/text-process/route.ts` - 智能文本处理API
- `app/api/research/route.ts` - 资料检索API
- `components/OutlineGenerator.tsx` - 大纲生成组件
- `components/SmartTextProcessor.tsx` - 智能文本处理组件
- `components/ResearchPanel.tsx` - 资料检索组件
- `components/SmartInserter.tsx` - 智能插入组件
- `utils/formatAnalyzer.ts` - 格式分析工具
- `utils/clientCache.ts` - 客户端缓存工具
- `utils/errorHandler.ts` - 错误处理工具

#### 🧪 测试套件

- Jest测试环境配置
- 单元测试和集成测试
- 测试覆盖率报告
- 模拟数据支持

#### 📚 文档

- 产品需求文档 (PRD.md)
- 技术设计文档 (TDD.md)
- Vercel部署指南 (VERCEL_DEPLOYMENT.md)
- 项目总结文档 (SUMMARY.md)

---

## 未来计划

### v2.4.0 - 用户体验优化 (计划中)

- 添加更多AI模型选择
- 优化响应速度和性能
- 增加批量处理功能
- 改进错误处理和用户反馈

### v2.5.0 - 功能扩展 (计划中)

- 添加更多文本处理模式
- 支持更多资料检索源
- 增加协作功能
- 添加导出和分享功能

### v3.0.0 - 架构升级 (计划中)

- 考虑添加后端数据库
- 实现用户账户系统
- 添加云端同步功能
- 支持更多文件格式

---

## 贡献指南

### 如何记录更新

1. 在完成功能开发后，更新此CHANGELOG.md文件
2. 按照版本号递增记录更新内容
3. 使用表情符号和分类标签组织内容
4. 详细描述技术改进和功能变化
5. 提交时在commit message中引用此文档

### 更新格式

```markdown
### vX.X.X - 版本名称 (日期)

#### 🆕 新增功能
- 功能描述

#### 🔧 技术改进
- 改进描述

#### 🐛 问题修复
- 修复描述

#### 📚 文档更新
- 文档描述
```

### 版本号规则

- **主版本号**: 重大架构变更或功能重构
- **次版本号**: 新功能添加或重要改进
- **修订版本号**: 问题修复或小改进

---

## 联系方式

如有问题或建议，请通过以下方式联系：

- GitHub Issues: [项目Issues页面]
- 邮箱: [联系邮箱]
- 文档: [项目文档]

---

*最后更新: 2025-09-17*
